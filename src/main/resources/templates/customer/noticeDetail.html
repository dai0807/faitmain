<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org"
				layout:decorate = "~{layout/customer_default_layout2}"
      			xmlns:layout = "http://www.ultraq.net.nz/thymeleaf/layout">
<head>	
	<th:block layout:fragment="title">
	
		<title>faitmain</title>
	</th:block>
	<script type="text/javascript">
	$(function(){

		function update(){
			
			console.log("공지사항  수정 눌림 ")
			var updateval =  $("#update").html() ;
			alert(updateval) ;
			
			if(updateval =='수정하기' ){
				
				$("#title").attr("readonly" , false) ; 
				$("#contents").attr("readonly" , false) ; 
				 $("#update").html('수정완료') 
				
			}else{
	
			   var formdata = $("#frm").serialize(); 
			   formdata = decodeURIComponent(formdata);
				alert( formdata) ;
			
				$.ajax({
					
					type:"POST" ,
					url:"/customer/json/updateCustomerBoard" ,
					data:formdata ,
					
					success: function(result){
						
						if(result == 1 ){
							alert("수정완료 ")  
						}else{
							 alert("수정이 완료 되지 못했습니다.  ")  
						}
						
					}
					
				}) ; // ajax  여기 까지 	
				
				$("#title").attr("readonly" , true) ; 
				$("#contents").attr("readonly" , true) ; 
				 $("#update").html('수정하기')  ;
				
			}// else 	
			
		}
	})

</script>

<script th:inline="javascript">
			/*<![CDATA[*/

			function deleteBoard(boardNumber, boardType) {

				
				console.log('boardType = '+ boardType);
				
				if (confirm(boardNumber + "번 게시글을 삭제할까요?")) {
					var uri = /*[[ @{/customer/deleteBoard} ]]*/ null;
					var html = "";

					html += '<form name="dataForm" action="'+uri+'" method="post">';
						html += '<input type="hidden" name="boardNumber" value="'+boardNumber+'" />';
						html += '<input type="hidden" name="boardType" value="'+boardType+'" />';
					html += '</form>';
					
					$("body").append(html);
					document.dataForm.submit();
				}
			
			}
			/*[- end of function -]*/

			/*]]>*/
		</script>
		
		<style>
		#out {
		 	width: 100%;
			padding: 20px;
			margin: 15px;
		 }
		#in {
		 	display: inline-block;
		 	
		 	height: 100px;
		 }
		</style>
</head>





<body>
	<th:block layout:fragment="content">
		<div id="out" class="container" th:action="@{/customer/detailBoard}">
	
			<div id="in" class="page-header">
				<h2>공지사항</h2>
				<hr />
			</div>
	     	   <form id="frm" method="post" >
   				 <input type="hidden" name="boardNumber" th:value="${customer.boardNumber}">
	   			 <input type="hidden" name="boardType" value='N'/>
	   			 
	   			 <table class="table">
	   			 <tbody>
					<tr>
						 <th:block   sec:authorize="isAuthenticated()" >
	       				 	<div class="btn_wrap text-center" sec:authorize="hasRole('ROLE_admin')">
								<th scope="row" style="padding:13px 0 0 15px;">글 번호</th>
								<td th:text="${customer.boardNumber}"></td>
								</div>
						</th:block>
					</tr>
					<tr>
						<th scope="row" style="padding:13px 0 0 15px;">작성자</th>
							<td th:text="${customer.customerId.id}"></td>
						<th scope="row" style="padding:13px 0 0 15px;">작성일</th>
							<td th:text="${#dates.format( customer.boardRegDate, 'yyyy-MM-dd HH:mm:ss' )}"></td>
						<th scope="row" style="padding:13px 0 0 15px;">조회수</th>
							<td th:text="${customer.viewCount}"></td>
					</tr>
					<tr>
						<th scope="row" style="padding:13px 0 0 15px;">제목</th>
						<td colspan="3">
							<input type="text" id="title" name="boardTitle" 
								th:value="${customer.boardTitle } "  readonly style="resize:none; border:none;" />
						</td>
						
					</tr>
					<tr>
						<td colspan="6"  class="view_text">
							<textarea title="내용" id="contents" name="boardContent"  class="form-control input-sm"  style="height: 500px; resize:none; border:none; min-height:350px; "
								th:text="${customer.boardContent }" readonly="readonly"  ></textarea>
							<span class="help-block"></span>
						</td>
					</tr>
				</tbody>
			</table>
	       
	        <th:block   sec:authorize="isAuthenticated()" >
		        <div class="btn_wrap text-center" sec:authorize="hasRole('ROLE_admin')">
		        
		        	<!-- <a th:href="@{/customer/openBoardList}" class="btn btn-default waves-effect waves-light">목록으로</a> -->
					<!--  <a th:href="@{/customer/addNotice( boardNumber=${customer.boardNumber} )}" class="btn btn-primary waves-effect waves-light">수정하기</a>   -->
		 		
					<button type="button" id="update" class="btn btn-danger waves-effect waves-light" th:onclick="update()" >수정하기</button>	
				
				
				
					
					<button type="button" class="btn btn-danger waves-effect waves-light" 
							th:onclick="deleteBoard([[${customer.boardNumber}]], [[${customer.boardType}]])">삭제하기</button>	
				</div>
			</th:block>
			
				<div class="btn_wrap text-center" >
					<a th:href="@{/customer/listBoard(boardType=${customer.boardType})}" class="btn btn-default waves-effect waves-light">목록으로</a>
				</div>
		 </form>
	</div>
	<!-- <th:block layout:fragment="script"> -->
	
	</th:block> 
</body>
</html> 