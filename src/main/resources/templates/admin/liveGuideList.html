<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org"
				layout:decorate = "~{layout/customer_default_layout2}"
      			xmlns:layout = "http://www.ultraq.net.nz/thymeleaf/layout"
      			xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link href="https://fonts.googleapis.com/css?family=Roboto:300,400&display=swap" rel="stylesheet">

    <link rel="stylesheet" th:href="@{/customerDesign/noticeListCss/fonts/icomoon/style.css}">

    <link rel="stylesheet"  th:href="@{/customerDesign/noticeListCss/css/owl.carousel.min.css}">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet"  th:href="@{/customerDesign/noticeListCss/css/bootstrap.min.css}">
    
    <!-- Style -->
    <link rel="stylesheet"  th:href="@{/customerDesign/noticeListCss/css/style.css}">

    <title>faitmain</title>
    <script src="http://code.jquery.com/jquery-1.6.4.min.js"></script>
	    <script type="text/javascript">
	    	$(function(){
	    		var checkObj = document.getElementByName("RowCheck");
	    		var rowCnt = checkObj.length;
	    		
	    		$("input[name='allCheck']").click(function(){
	    			var check_listArr = $("input[name='RowCheck']");
	    			for (var i=0; i<check_listArr.length; i++){
	    				check_listArr[i].checked = this.checked;
	    			}
	    		});
	    		
	    		$("input[name='RowCheck']").click(function(){
	    			if($("input[name='RowCheck'] : checked").length == rowCnt){
	    				$("input[name='allCheck']")[0].checked = true;
	    			}else{
	    				$("input[name='allCheck']")[0].checked = false;
	    			}
	    		});
	    	});
	    	
	    	function deleteValue(){
	    		var url = "deleteBoard";		//Controller로 보내고자하는 URL
	    		var valueArr = new Array();
	    		var list = $("input[name='RowCheck']");
	    		for(var i=0; i<list.length; i++){
	    			if(list[i].checked){		//체크되어 있으면 array에 값을 저장
	    				valueArr.push(list[i].value);
	    			}
	    		}
	    		
	    		if(valueArr.length == 0){
	    			alert("선택된 글이 없습니다.");
	    		}else{
	    			var chk = confirm("삭제하시겠습니까?");
	    			$ajax({
	    				url : url,
	    				type : 'POST',
	    				traditional : true,
	    				data : {
	    					valueArr : valueArr
	    				},
	    				success : function(jdata){
	    					if(jdata = 1){
	    						alert("삭제되었습니다.");
	    						location.replace("listBoard")
	    					}else{
	    						alert("삭제되지 않았습니다.")
	    					}
	    				}
	    			});
	    		}
	    		
	    	}
	    	
	    </script>
  </head>
  <body>
  
<article class = "nl-1" layout:fragment = "content">
    
    <div class="container">
    <input type="hidden" name="boardType" value='L'/> 
      <h3 class="mb-5">라이브가이드 리스트</h3>
      <hr/>

      <div class="table-responsive">
        <table class="table custom-table">
          <thead>
            <tr>
              <th scope="col"><input id="allCheck" type="checkbox" name="allCheck"/></th>
              <th scope="col">번호</th>
              <th scope="col">제목</th>
              <th scope="col">등록일</th>

            </tr>
          </thead>
          <tbody>
            <tr th:if="${not #lists.isEmpty( boardList )}" th:each="row : ${boardList}">
            	<td class="text_ct"><input name="guideCheckBx" type="checkbox" value="${row.boardNumber}"/></td>
				<td th:text="${row.boardNumber}"></td>
				<td class="text-left">
					<a th:href="@{/customer/detailBoard( boardNumber=${row.boardNumber})}" th:text="${row.boardTitle}"></a>
				</td>
				<td th:text="${#dates.format(row.boardRegDate, 'yyyy-MM-dd')}"></td>
			</tr>
            <tr th:unless="${not #lists.isEmpty( boardList )}">
				<td colspan="5">조회된 결과가 없습니다.</td>
			</tr>
          </tbody>
        </table>
      </div>
    
		<th:block sec:authorize="isAuthenticated()">
			<div class="btn_wrap text-right" sec:authorize="hasRole('ROLE_admin')">
				<a th:href="@{/customer/addLiveGuide}" class="btn btn-primary waves-effect waves-light">등록</a>
				<input type="button" value="선택삭제" class="btn btn-primary waves-effect waves-light" onclick="deleteValue();">	
			</div> 	
		</th:block>
		
    </div>
    
    <script type="text/javascript" th:src="@{/customerDesign/noticeListCss/js/jquery-3.3.1.min.js}"></script>
    <script type="text/javascript" th:src="@{/customerDesign/noticeListCss/js/popper.min.js}"></script>
    <script type="text/javascript" th:src="@{/customerDesign/noticeListCss/js/bootstrap.min.js}"></script>
    <script type="text/javascript" th:src="@{/customerDesign/noticeListCss/js/main.js}"></script>
 	
 </article>
 </body>
  
</html>
                   

            